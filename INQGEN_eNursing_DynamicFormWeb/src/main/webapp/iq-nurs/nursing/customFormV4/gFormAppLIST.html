<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=11;IE=10;IE=9;IE=8;IE=7">
    <meta name="viewport" content="width=device-width initial-scale=1.0 maximum-scale=1.0 user-scalable=yes"/>
    <META http-equiv="Expires" content="Mon, 26 Jul 1997 05:00:00 GMT">
    <META http-equiv="Last-Modified" content="Sat, 10 Nov 1997 09:08:07 GMT">
    <META http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate">
    <META http-equiv="Pragma" content="no-cache">
    <link rel="shortcut icon" href="iq-nurs/nursing/customFormV3/images/favicon.ico" type="image/x-icon"/>
    <title>臺北榮民總醫院個案整合照護管理系統（CICMS）</title>

    <script src="META-JS/properties.js?csSvnVersion="></script><!-- 基礎參數設定 -->
    <script src="iq-nurs/nursing/customFormV3/js2/jquery.js?csSvnVersion="></script>
    <script src="iq-nurs/nursing/customFormV3/js2/jquery.form.js?csSvnVersion="></script>
    <script src="iq-nurs/nursing/customFormV3/js2/jquery.twzipcode32.beta.js?csSvnVersion="></script>
    <script src="iq-nurs/nursing/customFormV3/js/json2.js?csSvnVersion="></script>
    <script src="iq-nurs/nursing/customFormV3/js/common.js?csSvnVersion="></script>
    <!-- <link rel="stylesheet" href="css/nurse_event.css?csSvnVersion=" id="nurse_event_css" class="defult_UI"> -->
    <link rel="stylesheet" href="css/bootstrap-datetimepicker.css?csSvnVersion=">

    <link rel="stylesheet" href="iq-nurs/nursing/customFormV3/css/dynamicForm.css?csSvnVersion="><!-- 動態表單基礎css -->
    <!-- 動態表單各家獨立的css -->
    <link rel="stylesheet" href="style/dynamicForm2/common.css?csSvnVersion="><!-- 通用 -->
    <link rel="stylesheet" href="style/dynamicForm2/list.css?csSvnVersion="><!-- list專用 -->
    <script src="js/util/datetimepicker/bootstrap-datetimepicker.js?csSvnVersion="></script>
    <script src="js/util/datetimepicker/locales/bootstrap-datetimepicker.zh-TW.js?csSvnVersion="></script>

    <script src="iq-nurs/nursing/customFormV3/js/includeHeadFileWeb.js?csSvnVersion="></script>
    <script src="iq-nurs/nursing/customFormV3/js/includeFootJsWeb.js?csSvnVersion="></script>
    <!--List特有區段 start-->
    <link rel="stylesheet" href="iq-nurs/nursing/customFormV3/css/list.css?csSvnVersion=">
    <script src="iq-nurs/nursing/customFormV3/js/list.js?csSvnVersion="></script>
    <!--List特有程式 end-->
    <!--Add特有區段 start-->
    <script src="iq-nurs/nursing/customFormV3/js/addAndUpd.js?csSvnVersion="></script>
    <!--Add特有程式 end-->

    <link rel="stylesheet" href="plugins/bootstrap/css/bootstrap.min.css?csSvnVersion=">
    <link rel="stylesheet" href="css/pushy.css?csSvnVersion=">
    <link rel="stylesheet" href="css/style.css?csSvnVersion=">
    <link rel="stylesheet" href="css/RWD1024_up.css?csSvnVersion=">
    <link rel="stylesheet" href="css/RWD768_up.css?csSvnVersion=">
    <link rel="stylesheet" href="css/RWD767_down.css?csSvnVersion=">
    <link rel="stylesheet" href="css/RWD_special.css?csSvnVersion=">
    <script src="js/patient/patient.js?csSvnVersion="></script>

</head>

<body class="content bodyBack" style="background-image: none;">

<!-- Pushy Menu -->
<nav class="pushy pushy-left">
    <div id="left" class="pushy-content" style="height: 95%;"></div>
    <div style="height: 5%;width: 100%;text-align: center;" onclick="returnIndex();">登出</div>
</nav>

<!-- Site Overlay -->
<div class="site-overlay"></div>

<div class="page-wrapper" id="container" style="overflow: hidden">
    <!-- top -->
    <div id="top" class="header"></div>

    <div class="content">
        <div class="container">
            <div id="myIframe" class="iframe_page PatientList" style="overflow-y:scroll;height: 200px;">
                <div id="Iframe" style="min-height: 0;"></div>
                <div id="myIframeContent"><form id="targetForm" class="form-horizontal" role="form"></form></div>
            </div>
        </div>
    </div>

    <div class="footer T_center">
        <a href="content.html"><img src="img/home.png" style="width: 30px;" alt=""></a>
    </div>
</div>
<!-- 进度条 -->
<div class="modal fade" id="processing" tabindex="-1" role="dialog" aria-hidden="true" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div style="text-align: center;width: 100%;">
            <div class="loading loadingPlus"></div>
            <div id="loadMsg"></div>
        </div>
    </div>
</div>

<script type="text/javascript" src="plugins/jquery/jquery-3.4.1.min.js?csSvnVersion="></script>
<script type="text/javascript" src="plugins/bootstrap/js/bootstrap.min.js?csSvnVersion="></script>
<script type="text/javascript" src="plugins/pushy.js?csSvnVersion=" ></script>
<script type="text/javascript" src="js/util/bootbox.js?csSvnVersion="></script>
<script type="text/javascript" src="js/core/common.js?csSvnVersion=" ></script>
<script src="js/routineEvaluation/routineEvaluation.js?csSvnVersion="></script>`
<script>
    $( function (){
        $.when(loadMenu(),loadTop()).then(menuClick).then(setPatientTitle);
    });
</script>
</body>

</html>
<!-- 用來產生動態表單的JS、CSS在這邊一併引入 (必須先引入jquery) -->
<script src="js/global/nis/v2.0/DateTime.js?csSvnVersion="></script>
<script src="js/global/nis/v2.0/modules/eNursing.js?csSvnVersion="></script>
<script src="js/global/nis/v2.0/modules/checkObjectFormat.js?csSvnVersion="></script>
<script src="js/global/nis/v2.0/modules/user.js?csSvnVersion="></script>
<script src="js/global/nis/v2.0/modules/station.js?csSvnVersion="></script>
<script src="js/global/nis/v2.0/modules/patient.js?csSvnVersion="></script>
<script src="js/global/nis/v2.0/modules/dynamicForm.js?csSvnVersion="></script>
<script src="js/global/nis/v2.0/modules/gForm.js?csSvnVersion="></script>
<script src="js/global/nis/v2.0/modules/fileUpload.js?csSvnVersion=" defer></script>
<script src="js/global/nis/v2.0/modules/test.js?csSvnVersion="></script>
<script src="js/global/nis/v2.0/modules/eNursing.init.js?csSvnVersion="></script>
<script src="js/global/nis/v2.0/forwardNull.js?csSvnVersion="></script>
<script src="js/global/nis/v2.0/process.js?csSvnVersion="></script>
<!-- Template模板 -->
<script src="js/util/template-web.js?csSvnVersion="></script>
<script src="js/util/template-transfer.js?csSvnVersion="></script>

<!-- 動態表單各家獨立的js (表單建置前) -->
<script src="js/dynamicForm2/pageNotReady/common.js?csSvnVersion="></script><!-- 通用 -->
<script src="js/dynamicForm2/pageNotReady/list.js?csSvnVersion="></script><!-- list專用 -->
<script>
    //Frame模板讀取來源 (true=本地端, false=資料庫)
    var loadLocalFrame;
    //Frame模板的init程式讀取來源 (true=本地端, false=資料庫)
    var loadLocalFrame_INIT;
    //指定某個formType (beanName)需要改為讀本地端
    var loadLocalFrame_formType;

    try {
        loadLocalFrame = isTestForm;
        loadLocalFrame_INIT = isTestForm;
        loadLocalFrame_formType = testFormType;
        if (isTestForm && isTestForm_byUrl) {
            window.localStorage["gFormAppLIST_sourceId"] = loadLocalFrame_formType;
            window.localStorage["gFormAppLIST_formType"] = loadLocalFrame_formType;
            window.localStorage["gFormAppLIST_frameModel"] = "gFormAppLIST";
            window.localStorage["gFormAppLIST_frameModel_INIT"] = "gFormAppLIST_INIT";
        }
    } catch (e) {
        console.log("偵測到疑似properties.js未宣告 isTestForm, testFormType, isTestForm_changeLocalStorage");
        loadLocalFrame = false;
        loadLocalFrame_INIT = false;
        loadLocalFrame_formType = "XXX";
    }
</script>

<script>
    var checkObjectFormat = nursing.createCheckObjectFormat();

    // eNursing.sendMsg=eNursing.sendMsgWS; //把WebSocket接口改為WebService接口，IE9以下不支援WebSocket
    //取得多層變數 multiLevel
    var multiLevel = nursing.createGForm().getUrlSessionToJson().multiLevel;
    //設定Title
    var headerTitle = window.localStorage["gFormAppLIST_headerTitle" + multiLevel];
    //設定此form的sourceId
    var sourceId = window.localStorage["gFormAppLIST_sourceId" + multiLevel];
    //設定此form的formType
    var formType = window.localStorage["gFormAppLIST_formType" + multiLevel];
    //設定此page的對應功能頁面
    var frameModel = window.localStorage["gFormAppLIST_frameModel" + multiLevel];  //AppList AppAdd  AppUpd  WebLIST WebADD WebPRINT WebUPD
    //設定此page的對應功能頁面程式
    var frameModel_INIT = window.localStorage["gFormAppLIST_frameModel_INIT" + multiLevel];  //AppLIST_INIT AppADD_INIT  AppUPD_INIT  WebLIST_INIT WebADD_INIT WebPRINT_INIT WebUPD_INIT

    //登入者
    var user = nursing.getUser().getCurrent();
    //登入者ID
    var userId = user.loginId;
    //登入者姓名
    var userName = user.fullName;

    //user所屬病區
    var userPossessive = window.localStorage["userPossessive"] ? window.localStorage["userPossessive"].split(",") : [];
    //病區mapping
    var userPossessiveMap = window.localStorage["userPossessiveMap"] ? JSON.parse(window.localStorage["userPossessiveMap"]) : {};
    //user所屬群組
    var userPosition = window.localStorage["userPosition"] ? window.localStorage["userPosition"].split(",") : [];
    //當前頁面狀態
    var thisPageStatus = "LIST";
    //app--title离线缓存使用
    var gForm_Title= null ;
    //以管理介面導入頁面
    if (window.localStorage["loadEditorFrame_INIT"]) {
        window.localStorage.removeItem("loadEditorFrame_INIT");
        //因代碼風險關係自2022.04.08之後已作廢
        // var loadEditorFrame_INIT_context=JSON.parse(window.localStorage["loadEditorFrame_INIT_context"]);
        //2022.04.08之後改用
        var loadEditorFrame_INIT_context=JSON.parse(parent.$("#previewIframe").data("loadEditorFrame_INIT_context"));
        appendInit(loadEditorFrame_INIT_context.content);
        window.localStorage.removeItem("loadEditorFrame_INIT_context");
    }
    //讀取本地端init
    else if (loadLocalFrame_INIT && formType == loadLocalFrame_formType) {
        $.ajax({url: "frame/gFormAppLIST_INIT.html", cache: false, async: false}).done(function (context) {
            appendInit(context);
        }).fail(function (err) {
            successCall("未找到本地端表单模板...");
        });
    }
    //讀取資料庫init
    else {
        frame_init();

        function frame_init() {
            if (window.console) console.log(nursing);
            //基础参数
            var basicParam = nursing.getBasicParam();
            //動態表單
            var dynamicForm = null;
            dynamicForm = nursing.getDynamicForm();
            //依據formModel(表單名)、frameModel(對應頁面) 取得最新版的formFrame(表單外框)
            dynamicForm.searchParamDF.formType = formType;
            dynamicForm.searchParamDF.frameModel = frameModel_INIT;
            basicParam.getCurrDynamicFormFrameByformTypeFrameModel(dynamicForm, function (formFrame) {
                appendInit(formFrame.content);
            }, function () {
            });
        }
    }

    function appendInit(context) {
        $("body").append(context);
    }
</script>